# ะฃัะพะบ 28: HTTP-ะทะฐะฟัะพัั ั Dio

## ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
lesson_28/
โโโ app/                          # Flutter ะฟัะธะปะพะถะตะฝะธะต
โ   โโโ lib/
โ   โ   โโโ models/
โ   โ   โ   โโโ post.dart        # ะะพะดะตะปั ะดะฐะฝะฝัั Post
โ   โ   โโโ services/
โ   โ   โ   โโโ dio_client.dart  # ะะฐัััะพะนะบะฐ Dio ะบะปะธะตะฝัะฐ
โ   โ   โ   โโโ api_service.dart # API ัะตัะฒะธั ั ะผะตัะพะดะฐะผะธ
โ   โ   โโโ screens/
โ   โ   โ   โโโ dio_demo_screen.dart # ะะตะผะพะฝัััะฐัะธะพะฝะฝัะน ัะบัะฐะฝ
โ   โ   โโโ main.dart            # ะขะพัะบะฐ ะฒัะพะดะฐ
โ   โโโ pubspec.yaml             # ะะฐะฒะธัะธะผะพััะธ
โโโ notes/
โ   โโโ README.md                # ะะพะฝัะฟะตะบั ะปะตะบัะธะธ
โโโ Homework28.txt               # ะะฐะดะฐะฝะธะต
โโโ ะะตะฝั-28.pptx                # ะัะตะทะตะฝัะฐัะธั
```

## ะัะฟะพะปะฝะตะฝะฝัะต ะทะฐะดะฐัะธ

### โ ะะฑัะทะฐัะตะปัะฝัะต ะทะฐะดะฐัะธ

1. **Dio-ะบะปะธะตะฝั ั baseUrl, timeouts ะธ ะปะพะณะธัะพะฒะฐะฝะธะตะผ**
   - ะะตะฐะปะธะทะพะฒะฐะฝ ะฒ `lib/services/dio_client.dart`
   - ะะฐัััะพะตะฝั connectTimeout, receiveTimeout, sendTimeout (10 ัะตะบัะฝะด)
   - ะะพะฑะฐะฒะปะตะฝ LoggingInterceptor ะดะปั ะปะพะณะธัะพะฒะฐะฝะธั ะทะฐะฟัะพัะพะฒ/ะพัะฒะตัะพะฒ
   - BaseURL: `https://jsonplaceholder.typicode.com`

2. **ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ**
   - ะะตะฐะปะธะทะพะฒะฐะฝะฐ ะฒ `lib/services/api_service.dart` (ะผะตัะพะด `_handleError`)
   - ะะฐะทะฝัะต ัะพะพะฑัะตะฝะธั ะดะปั ััะฐััั-ะบะพะดะพะฒ: 400, 401, 403, 404, 500, 502, 503
   - ะัะดะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ัะตัะตะฒัั ะพัะธะฑะพะบ (timeout, connection error)
   - ะะพะฝััะฝัะต ัะพะพะฑัะตะฝะธั ั ัะผะพะดะทะธ ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั

3. **ะัะผะตะฝะฐ ะทะฐะฟัะพัะฐ (CancelToken)**
   - ะะตะฐะปะธะทะพะฒะฐะฝะฐ ะฒ `lib/screens/dio_demo_screen.dart`
   - CancelToken ัะพะทะดะฐะตััั ะดะปั ะบะฐะถะดะพะณะพ ะทะฐะฟัะพัะฐ
   - ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะผะตะฝะฐ ะฒ ะผะตัะพะดะต `dispose()`
   - ะะฝะพะฟะบะฐ ะดะปั ัััะฝะพะน ะพัะผะตะฝั ะทะฐะฟัะพัะฐ

### โ ะะฟัะธะพะฝะฐะปัะฝัะต ะทะฐะดะฐัะธ

4. **Retry ะผะตัะฐะฝะธะทะผ ะธ ะฟัะพะณัะตัั-ะธะฝะดะธะบะฐัะพั**
   - RetryInterceptor ะฒ `lib/services/dio_client.dart`
   - ะะพ 2 ะฟะพะฒัะพัะฝัั ะฟะพะฟััะพะบ ะฟัะธ ัะตัะตะฒัั ะพัะธะฑะบะฐั
   - ะัะพะณัะตัั-ะธะฝะดะธะบะฐัะพัั ะทะฐะณััะทะบะธ (LinearProgressIndicator)
   - ะัะพะฑัะฐะถะตะฝะธะต ะฟัะพัะตะฝัะฐ ะทะฐะณััะทะบะธ/ะพัะฟัะฐะฒะบะธ

5. **ะะฐะณััะทะบะฐ ัะฐะนะปะฐ ั onReceiveProgress**
   - ะะตะฐะปะธะทะพะฒะฐะฝะฐ ะฒ `lib/services/api_service.dart` (ะผะตัะพะด `uploadFile`)
   - ะะพะดะดะตัะถะบะฐ image_picker ะดะปั ะฒัะฑะพัะฐ ะธะทะพะฑัะฐะถะตะฝะธะน
   - ะััะปะตะถะธะฒะฐะฝะธะต ะฟัะพะณัะตััะฐ ัะตัะตะท onSendProgress
   - FormData ั MultipartFile

## ะะปััะตะฒัะต ะฒะพะทะผะพะถะฝะพััะธ ะดะตะผะพ-ะฟัะธะปะพะถะตะฝะธั

### ะัะฝะพะฒะฝัะต ะพะฟะตัะฐัะธะธ:
- ๐ฅ **ะะฐะณััะทะธัั ะฟะพััั** - GET ะทะฐะฟัะพั ั ะฟัะพะณัะตััะพะผ ะทะฐะณััะทะบะธ
- โ **ะกะพะทะดะฐัั ะฟะพัั** - POST ะทะฐะฟัะพั ั ะฟัะพะณัะตััะพะผ ะพัะฟัะฐะฒะบะธ
- โ๏ธ **ะะฑะฝะพะฒะธัั ะฟะพัั** - PUT ะทะฐะฟัะพั (ัะตัะตะท ะผะตะฝั ะฒ ะบะฐััะพัะบะต)
- ๐๏ธ **ะฃะดะฐะปะธัั ะฟะพัั** - DELETE ะทะฐะฟัะพั (ัะตัะตะท ะผะตะฝั ะฒ ะบะฐััะพัะบะต)
- ๐ **ะะฐะณััะทะธัั ัะฐะนะป** - ะัะฑะพั ะธะทะพะฑัะฐะถะตะฝะธั ะธ upload ั ะฟัะพะณัะตััะพะผ
- ๐ซ **ะัะผะตะฝะธัั** - ะัะผะตะฝะฐ ัะตะบััะตะณะพ ะทะฐะฟัะพัะฐ

### UI ัะปะตะผะตะฝัั:
- ะะฝะดะธะบะฐัะพั ะทะฐะณััะทะบะธ (CircularProgressIndicator)
- ะัะพะณัะตัั-ะฑะฐัั ะดะปั upload/download (LinearProgressIndicator)
- ะกะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั (ะบัะฐัะฝะฐั ะบะฐััะพัะบะฐ)
- ะกะพะพะฑัะตะฝะธั ะพะฑ ััะฟะตัะต (ะทะตะปะตะฝะฐั ะบะฐััะพัะบะฐ)
- ะกะฟะธัะพะบ ะฟะพััะพะฒ ั ะบะฐััะพัะบะฐะผะธ
- ะะตะฝั ะดะตะนััะฒะธะน ะดะปั ะบะฐะถะดะพะณะพ ะฟะพััะฐ

## ะขะตัะฝะพะปะพะณะธะธ ะธ ะฟะฐััะตัะฝั

### ะัะฟะพะปัะทัะตะผัะต ะฟะฐะบะตัั:
- `dio: ^5.4.0` - HTTP ะบะปะธะตะฝั
- `image_picker: ^1.0.7` - ะัะฑะพั ะธะทะพะฑัะฐะถะตะฝะธะน
- `path_provider: ^2.1.2` - ะะฐะฑะพัะฐ ั ะฟัััะผะธ

### ะะฐััะตัะฝั ะฟัะพะตะบัะธัะพะฒะฐะฝะธั:
- **Singleton** - ะดะปั Dio ะบะปะธะตะฝัะฐ
- **Result Pattern** - ApiResult<T> ะดะปั ัะธะฟะพะฑะตะทะพะฟะฐัะฝะพััะธ
- **Interceptor Pattern** - ะดะปั ะปะพะณะธัะพะฒะฐะฝะธั ะธ retry
- **Repository Pattern** - ApiService ะบะฐะบ ัะปะพะน ะดะฐะฝะฝัั

### ะััะธัะตะบัััะฝัะต ัะตัะตะฝะธั:
- ะะฐะทะดะตะปะตะฝะธะต ะฝะฐ ัะปะพะธ (models, services, screens)
- ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- ะขะธะฟะธะทะธัะพะฒะฐะฝะฝัะต API ัะตะทัะปััะฐัั
- ะฃะฟัะฐะฒะปะตะฝะธะต ะถะธะทะฝะตะฝะฝัะผ ัะธะบะปะพะผ ะทะฐะฟัะพัะพะฒ

## ะะฐะบ ะทะฐะฟัััะธัั

```bash
# ะะตัะตะนัะธ ะฒ ะดะธัะตะบัะพัะธั ะฟัะธะปะพะถะตะฝะธั
cd lessons/lesson_28/app

# ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
flutter pub get

# ะะฐะฟัััะธัั ะฝะฐ ัะผัะปััะพัะต/ััััะพะนััะฒะต
flutter run
```

## ะขะตััะธัะพะฒะฐะฝะธะต

### API endpoint:
ะัะฟะพะปัะทัะตััั [JSONPlaceholder](https://jsonplaceholder.typicode.com/) - ะฑะตัะฟะปะฐัะฝัะน fake REST API ะดะปั ัะตััะธัะพะฒะฐะฝะธั:
- GET /posts - ัะฟะธัะพะบ ะฟะพััะพะฒ
- GET /posts/{id} - ะฟะพัั ะฟะพ ID
- POST /posts - ัะพะทะดะฐะฝะธะต ะฟะพััะฐ
- PUT /posts/{id} - ะพะฑะฝะพะฒะปะตะฝะธะต ะฟะพััะฐ
- DELETE /posts/{id} - ัะดะฐะปะตะฝะธะต ะฟะพััะฐ

### ะขะตััะพะฒัะต ััะตะฝะฐัะธะธ:
1. ะะฐะณััะทะบะฐ ะฟะพััะพะฒ - ะดะพะปะถะฝะฐ ะฟะพะบะฐะทะฐัั ะฟัะพะณัะตัั ะธ ัะฟะธัะพะบ
2. ะกะพะทะดะฐะฝะธะต ะฟะพััะฐ - ะดะพะปะถะฝะฐ ะฟะพะบะฐะทะฐัั ะฟัะพะณัะตัั ะพัะฟัะฐะฒะบะธ
3. ะัะผะตะฝะฐ ะทะฐะฟัะพัะฐ - ะดะพะปะถะฝะฐ ะพััะฐะฝะพะฒะธัั ะพะฟะตัะฐัะธั
4. ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ - ะผะพะถะฝะพ ะฟัะพัะตััะธัะพะฒะฐัั ะพัะบะปััะธะฒ ะธะฝัะตัะฝะตั
5. Retry - ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะธ ัะตัะตะฒัั ะฟัะพะฑะปะตะผะฐั

## ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

### ะขะธะฟั ะพัะธะฑะพะบ:
- โฑ๏ธ Timeout (connectTimeout, receiveTimeout, sendTimeout)
- ๐ ะะตั ะธะฝัะตัะฝะตัะฐ (connectionError)
- โ HTTP ะพัะธะฑะบะธ (400, 401, 403, 404, 500+)
- ๐ซ ะัะผะตะฝะฐ ะทะฐะฟัะพัะฐ (cancel)
- โ ะะตะธะทะฒะตััะฝัะต ะพัะธะฑะบะธ

### ะกััะฐัะตะณะธั ะพะฑัะฐะฑะพัะบะธ:
1. ะะตัะตัะฒะฐั ะฒ ApiService
2. ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะฒ ะฟะพะฝััะฝะพะต ัะพะพะฑัะตะฝะธะต
3. ะะพะทะฒัะฐั ApiResult.failure
4. ะัะพะฑัะฐะถะตะฝะธะต ะฒ UI

## ะะพะณะธัะพะฒะฐะฝะธะต

ะ ะบะพะฝัะพะปะธ ะผะพะถะฝะพ ัะฒะธะดะตัั:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ค REQUEST: GET https://jsonplaceholder.typicode.com/posts
Headers: {...}
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ฅ RESPONSE: 200 https://jsonplaceholder.typicode.com/posts
Data: [...]
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะัะธ ะพัะธะฑะบะฐั:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ERROR: DioExceptionType.connectionError
Message: ...
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Retry attempt 1/2
```

## Best Practices ะฟัะธะผะตะฝะตะฝั

โ ะขะฐะนะผ-ะฐััั ะดะปั ะฒัะตั ัะธะฟะพะฒ ะทะฐะฟัะพัะพะฒ
โ Centralized error handling
โ CancelToken ั cleanup ะฒ dispose
โ ะะฝัะตััะตะฟัะพัั ะดะปั ะบัะพัั-ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
โ Progress tracking ะดะปั UX
โ Retry mechanism ะดะปั ะฝะฐะดะตะถะฝะพััะธ
โ Singleton ะดะปั ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐะฝะธั Dio
โ Type-safe API ัะตะทัะปััะฐัั
โ ะัะพะฒะตัะบะฐ mounted ะฟะตัะตะด setState

## ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะฐัะตัะธะฐะปั

ะกะผ. `notes/README.md` ะดะปั ะฟะพะปะฝะพะณะพ ะบะพะฝัะฟะตะบัะฐ ะปะตะบัะธะธ ั:
- ะะตัะฐะปัะฝัะผ ะพะฟะธัะฐะฝะธะตะผ API
- ะัะธะผะตัะฐะผะธ ะบะพะดะฐ
- ะกัะฐะฒะฝะตะฝะธะตะผ ั ะดััะณะธะผะธ HTTP ะบะปะธะตะฝัะฐะผะธ
- ะะพะปะฝัะผ ัะฟะธัะบะพะผ best practices
- ะะพะปะตะทะฝัะผะธ ัััะปะบะฐะผะธ

## ะะฒัะพั

ะัะฟะพะปะฝะตะฝะพ ะฒ ัะฐะผะบะฐั ะบัััะฐ Flutter Development 2025-2026
